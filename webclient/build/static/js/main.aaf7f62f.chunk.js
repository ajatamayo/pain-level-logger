(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{101:function(e,t){e.exports={allowedEmailDomain:"qwikwire.com"}},230:function(e,t,r){e.exports=r(484)},271:function(e,t){},273:function(e,t){},307:function(e,t){},308:function(e,t){},356:function(e,t,r){},413:function(e,t,r){},477:function(e,t,r){},481:function(e,t,r){},484:function(e,t,r){"use strict";r.r(t);var n=r(1),a=r.n(n),c=r(14),o=r.n(c),s=r(23),u=r(80),i=r(37),l=r(227),p=r(27),m=r(17),d=r.n(m),h=r(149),f=r(12),b=r(39),g=r(81),v="LOGIN_REQUEST",O="LOGIN_SUCCESS",j="LOGINCODE_REQUEST",y="LOGINCODE_SUCCESS",E="LOGOUT_REQUEST",k="APP_ALERT",x="APP_ALERT_CLEAR",w="SHORTEN_URL_REQUEST",S="SHORTEN_URL_SUCCESS",I="SHORTEN_URL_FAILURE",R="DECODE_URL_REQUEST",U="DECODE_URL_SUCCESS";function C(e){return{type:y,uid:e}}function T(e){return{type:k,message:e,alertType:"success"}}function N(e,t){return{type:k,message:e,alertType:"error",error:t}}var P=r(25),L=r(211),q=r.n(L),D="clientId",F="accessToken",_="refreshToken";function A(){return q.a.create({baseURL:"/api",headers:Object(P.a)({},function(){var e=localStorage.getItem(F),t=localStorage.getItem(_),r=localStorage.getItem(D);return t&&r?{Authorization:"Bearer ".concat(e),"X-Refresh-Token":t,"X-Client-Id":r}:{}}())})}var G=function(){function e(e){var t=e.headers["x-access-token"];return t&&localStorage.setItem(F,t),e}return{get:function(){var t;return(t=A()).get.apply(t,arguments).then(e)},post:function(){var t;return(t=A()).post.apply(t,arguments).then(e)},put:function(){var t;return(t=A()).put.apply(t,arguments).then(e)},delete:function(){var t;return(t=A()).delete.apply(t,arguments).then(e)}}}();function M(e){return G.post("/auth/login",Object(P.a)({grantType:"password"},e))}function W(e){return G.post("/auth/send-code",e)}function Q(e){return G.delete("/auth/token",{data:e})}var B=r(142),z=r(212),H=r.n(z);function J(){return X.apply(this,arguments)}function X(){return(X=Object(B.a)(d.a.mark(function e(){var t,r,n=arguments;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:24,e.prev=1,r=H.a.randomBytes(t),e.abrupt("return",r.toString("hex"));case 6:return e.prev=6,e.t0=e.catch(1),e.abrupt("return",!1);case 9:case"end":return e.stop()}},e,this,[[1,6]])}))).apply(this,arguments)}function Y(){return $.apply(this,arguments)}function $(){return($=Object(B.a)(d.a.mark(function e(){var t,r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=localStorage.getItem(D)){e.next=8;break}return e.next=5,J(40);case 5:r=e.sent,localStorage.setItem(D,r),t=r;case 8:return e.abrupt("return",t);case 11:return e.prev=11,e.t0=e.catch(0),e.abrupt("return",!1);case 14:case"end":return e.stop()}},e,this,[[0,11]])}))).apply(this,arguments)}var K=d.a.mark(te),V=d.a.mark(re),Z=d.a.mark(ne),ee=d.a.mark(ae);function te(e){var t,r,n,a,c,o,s,u;return d.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return t=e.code,r=e.uid,i.prev=1,i.next=4,Object(f.b)(Y);case 4:return n=i.sent,i.next=7,Object(f.b)(M,{clientId:n,code:t,uid:r});case 7:if(a=i.sent,!a.data.success){i.next=22;break}return c=a.data,o=c.accessToken,s=c.refreshToken,localStorage.setItem(D,n),localStorage.setItem(F,o),localStorage.setItem(_,s),i.next=16,Object(f.c)({type:O,accessToken:o});case 16:return i.next=18,Object(f.c)(T("Login successful."));case 18:return i.next=20,Object(f.c)(Object(g.push)("/"));case 20:i.next=24;break;case 22:return i.next=24,Object(f.c)(N(a.data.message));case 24:i.next=31;break;case 26:return i.prev=26,i.t0=i.catch(1),u=i.t0.response.data.message,i.next=31,Object(f.c)(N(u,i.t0));case 31:case"end":return i.stop()}},K,this,[[1,26]])}function re(){var e,t;return d.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return e=localStorage.getItem(D),t=localStorage.getItem(_),r.prev=2,r.next=5,Object(f.b)(Q,{clientId:e,refreshToken:t});case 5:r.next=9;break;case 7:r.prev=7,r.t0=r.catch(2);case 9:return localStorage.removeItem(D),localStorage.removeItem(F),localStorage.removeItem(_),r.next=12,Object(f.c)(Object(g.push)("/"));case 12:case"end":return r.stop()}},V,this,[[2,7]])}function ne(e){var t,r,n,a,c,o;return d.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return t=e.email,s.prev=1,s.next=4,Object(f.b)(W,{email:t});case 4:if(r=s.sent,n=r.data,a=n.success,c=n.uid,!a){s.next=13;break}return s.next=9,Object(f.c)(T("Login code sent to ".concat(t,".")));case 9:return s.next=11,Object(f.c)(C(c));case 11:s.next=15;break;case 13:return s.next=15,Object(f.c)(N("Welp. Something aint right there. :/"));case 15:s.next=22;break;case 17:return s.prev=17,s.t0=s.catch(1),o=Object(b.get)(s.t0,"response.data.message"),s.next=22,Object(f.c)(N(o||"Woops, something went wrong. :((("));case 22:case"end":return s.stop()}},Z,this,[[1,17]])}function ae(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(f.a)([Object(f.d)(v,te),Object(f.d)(E,re),Object(f.d)(j,ne)]);case 2:case"end":return e.stop()}},ee,this)}var ce=[ae()];function oe(e,t,r){return{type:S,longUrl:e,shortUrl:t,pk:r}}function se(){return{type:I}}function ue(e){return{type:U,url:e}}function ie(e){return G.post("/shortener",e)}function le(e){var t=e.encodedPk;return G.get("/shortener/decode/".concat(t))}var pe=d.a.mark(he),me=d.a.mark(fe),de=d.a.mark(be);function he(e){var t,r,n,a,c,o,s,u;return d.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return t=e.url,i.prev=1,i.next=4,Object(f.b)(ie,{url:t});case 4:if(r=i.sent,n=r.data,a=n.success,c=n.longUrl,o=n.shortUrl,s=n.pk,!a){i.next=13;break}return i.next=9,Object(f.c)(T("".concat(c," shortened! \\:D/")));case 9:return i.next=11,Object(f.c)(oe(c,o,s));case 11:i.next=17;break;case 13:return i.next=15,Object(f.c)(se());case 15:return i.next=17,Object(f.c)(N("Woah! Something aint right there. :/"));case 17:i.next=26;break;case 19:return i.prev=19,i.t0=i.catch(1),i.next=23,Object(f.c)(se());case 23:return u=Object(b.get)(i.t0,"response.data.message"),i.next=26,Object(f.c)(N(u||"Oh no! Something went wrong. :((("));case 26:case"end":return i.stop()}},pe,this,[[1,19]])}function fe(e){var t,r,n,a;return d.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return t=e.encodedPk,c.prev=1,c.next=4,Object(f.b)(le,{encodedPk:t});case 4:return r=c.sent,n=r.data.url,c.next=8,Object(f.c)(ue(n));case 8:return c.next=10,Object(f.b)(function(){window.location.href=n});case 10:c.next=17;break;case 12:return c.prev=12,c.t0=c.catch(1),a=Object(b.get)(c.t0,"response.data.message"),c.next=17,Object(f.c)(N(a||"Oh no! Something went wrong. :((("));case 17:case"end":return c.stop()}},me,this,[[1,12]])}function be(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(f.a)([Object(f.d)(w,he),Object(f.d)(R,fe)]);case 2:case"end":return e.stop()}},de,this)}var ge=[be()],ve=d.a.mark(Oe);function Oe(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(f.a)(Object(h.a)(ce).concat(Object(h.a)(ge)));case 2:case"end":return e.stop()}},ve,this)}var je=r(213),ye=r.n(je),Ee={isFetching:!1,errorMessage:null,message:null};var ke,xe=Object(i.c)({login:(ke={request:v,success:O},function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ee,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ke.request:return Object(P.a)({},e,{isFetching:!0,errorMessage:null,message:null});case ke.success:return Object(P.a)({},e,{isFetching:!1,message:t.message});default:return e}}),isAuthenticated:function(){return!!localStorage.getItem(F)},user:function(){try{var e=localStorage.getItem(F);return ye()(e)}catch(t){return null}},logincode:function(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{uid:null},r=arguments.length>1?arguments[1]:void 0;switch(r.type){case e.success:return Object(P.a)({},t,{uid:r.uid});default:return t}}}({success:y})}),we={message:null,alertType:null,error:null};var Se=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:we,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case k:return Object(P.a)({},e,{message:t.message,alertType:t.alertType,error:t.error});case x:return Object(P.a)({},e,{message:null,alertType:null,error:null});default:return e}},Ie={urlPairs:[],isFetching:!1,redirectUrl:""};var Re=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ie,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case w:return Object(P.a)({},e,{isFetching:!0});case S:var r=e.urlPairs,n=t.longUrl,a=t.shortUrl,c=t.pk;return r.some(function(e){return e.pk===c})||r.unshift({longUrl:n,shortUrl:a,pk:c}),Object(P.a)({},e,{isFetching:!1,urlPairs:r});case I:return Object(P.a)({},e,{isFetching:!1});case U:return Object(P.a)({},e,{redirectUrl:t.url});default:return e}},Ue=Object(i.c)({router:g.routerReducer,auth:xe,app:Se,shortener:Re}),Ce=Object(p.a)(),Te=Object(l.a)(),Ne=[Te,Object(u.routerMiddleware)(Ce)],Pe=i.d.apply(void 0,[i.a.apply(void 0,Ne)].concat([])),Le=Object(i.e)(Object(u.connectRouter)(Ce)(function(e,t){return t.type===E?Ue(void 0,t):Ue(e,t)}),{},Pe);Te.run(Oe);var qe=Le,De=r(487),Fe=r(488),_e=r(486),Ae=r(45),Ge=r(46),Me=r(49),We=r(47),Qe=r(50),Be=r(33),ze=r(492),He=(r(356),function(e){function t(e){var r;return Object(Ae.a)(this,t),(r=Object(Me.a)(this,Object(We.a)(t).call(this,e))).handleClose=r.handleClose.bind(Object(Be.a)(Object(Be.a)(r))),r}return Object(Qe.a)(t,e),Object(Ge.a)(t,[{key:"handleClose",value:function(){this.props.appAlertClear()}},{key:"render",value:function(){var e,t;return 401===Object(b.get)(this,"props.error.response.status")&&(e="Please login.",t="warning"),null!=this.props.message&&a.a.createElement("div",{className:"alert-wrapper"},a.a.createElement(ze.a,{message:e||this.props.message,type:t||this.props.alertType,showIcon:!0,banner:!0,closable:!0,afterClose:this.handleClose}))}}]),t}(n.Component)),Je={appAlertClear:function(){return{type:x}}},Xe=Object(s.connect)(function(e){var t=e.app;return{message:t.message,alertType:t.alertType,error:t.error}},Je)(He),Ye=r(489),$e=r(491),Ke=r(79),Ve=r(485),Ze=r(146),et=r.n(Ze),tt=r(101),rt=(r(413),Ye.a.Item),nt=function(e){function t(e){var r;return Object(Ae.a)(this,t),(r=Object(Me.a)(this,Object(We.a)(t).call(this,e))).emailInput=null,r.codeInput=null,r.setEmailInputRef=function(e){r.emailInput=e},r.setCodeInputRef=function(e){r.codeInput=e},r.handleSubmit=r.handleSubmit.bind(Object(Be.a)(Object(Be.a)(r))),r}return Object(Qe.a)(t,e),Object(Ge.a)(t,[{key:"componentDidMount",value:function(){this.emailInput&&this.emailInput.focus()}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),this.props.form.validateFields(function(e){if(!e){var r=t.emailInput.input.value,n=t.codeInput&&t.codeInput.input.value;if(t.props.uid){var a=et.a.parse(t.props.location.search).uid;t.props.loginRequest(n,t.props.uid||a)}else t.props.logincodeRequest("".concat(r,"@").concat(tt.allowedEmailDomain))}})}},{key:"render",value:function(){var e=et.a.parse(this.props.location.search),t=e.code,r=e.uid;if(t&&r)return this.props.loginRequest(t,r),a.a.createElement("p",null,"Logging you in...");var n=this.props.form.getFieldDecorator;return a.a.createElement(Ye.a,{onSubmit:this.handleSubmit,className:"login-form"},a.a.createElement("p",null,"Login using your ".concat(tt.allowedEmailDomain," email to use this service.")),a.a.createElement(rt,{className:"email-form-item"},n("email",{rules:[{required:!0,message:"Please input your email!"}]})(a.a.createElement($e.a,{ref:this.setEmailInputRef,prefix:a.a.createElement(Ke.a,{type:"user"}),placeholder:"you",addonAfter:"@".concat(tt.allowedEmailDomain)}))),this.props.uid&&a.a.createElement(rt,{className:"login-code-form-item"},n("code",{rules:[{required:!0,message:"Please input your login code!"}]})(a.a.createElement($e.a,{ref:this.setCodeInputRef,prefix:a.a.createElement(Ke.a,{type:"lock"}),placeholder:"Paste your-temporary-login-code"}))),a.a.createElement(rt,null,a.a.createElement(Ve.a,{type:"primary",htmlType:"submit",className:"login-form-button"},"Log in")))}}]),t}(n.Component);nt.defaultProps={uid:""};var at={loginRequest:function(e,t){return{type:v,code:e,uid:t}},logincodeRequest:function(e){return{type:j,email:e}}},ct=Object(_e.a)(Object(s.connect)(function(e){return{uid:e.auth.logincode.uid}},at)(Ye.a.create()(nt))),ot=r(490),st=r(222),ut=(r(477),Ye.a.Item),it=function(e){function t(e){var r;return Object(Ae.a)(this,t),(r=Object(Me.a)(this,Object(We.a)(t).call(this,e))).urlInput=null,r.setUrlInputRef=function(e){r.urlInput=e},r.handleSubmit=r.handleSubmit.bind(Object(Be.a)(Object(Be.a)(r))),r}return Object(Qe.a)(t,e),Object(Ge.a)(t,[{key:"componentDidMount",value:function(){this.urlInput&&this.urlInput.focus()}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),this.props.form.validateFields(function(e){if(!e){var r=t.urlInput.input.value;t.props.shortenUrlRequest(r)}})}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return a.a.createElement(n.Fragment,null,a.a.createElement(Ye.a,{onSubmit:this.handleSubmit,layout:"inline",className:"shortener-form"},a.a.createElement("p",null,"Welcome, ".concat(this.props.displayName,"! Enter a url to shorten :)")),a.a.createElement(ut,{className:"url-input-form-item"},e("url",{rules:[{required:!0,message:"You know you need a url right? :/"}]})(a.a.createElement($e.a,{ref:this.setUrlInputRef,prefix:a.a.createElement(Ke.a,{type:"global"}),placeholder:"https://aqwire.io",disabled:this.props.isFetching}))),a.a.createElement(ut,{className:"shortener-button-form-item"},a.a.createElement(Ve.a,{type:"primary",htmlType:"submit",className:"shortener-form-button"},"Get shortlink!"))),!!this.props.urlPairs.length&&a.a.createElement("div",{className:"urls"},this.props.urlPairs.map(function(e){return a.a.createElement("div",{key:e.pk,className:"url"},a.a.createElement("div",{className:"long-url"},e.longUrl),a.a.createElement("div",{className:"short-url"},a.a.createElement("span",{className:"display"},e.shortUrl),a.a.createElement(st.CopyToClipboard,{text:e.shortUrl},a.a.createElement(ot.a,{trigger:"click",title:"Copied ".concat(e.shortUrl," to clipboard!")},a.a.createElement(Ve.a,{ghost:!0,type:"primary",size:"small",icon:"copy"},"Copy")))))})))}}]),t}(n.Component),lt={shortenUrlRequest:function(e){return{type:w,url:e}}},pt=Object(s.connect)(function(e){var t=e.shortener;return{urlPairs:t.urlPairs,isFetching:t.isFetching,displayName:Object(b.get)(e,"auth.user.user.displayName")}},lt)(Ye.a.create()(it)),mt={logoutRequest:function(){return{type:E}}},dt=Object(s.connect)(function(e){return{isAuthenticated:e.auth.isAuthenticated}},mt)(function(e){return e.isAuthenticated?a.a.createElement("div",{style:{paddingTop:"80px"}},a.a.createElement(Ve.a,{onClick:e.logoutRequest,style:{marginRight:0},size:"small"},"Logout")):null}),ht=Object(s.connect)(function(e){return{isAuthenticated:e.auth.isAuthenticated}})(function(e){return a.a.createElement(n.Fragment,null,a.a.createElement("h1",null,"aqwi.re url shortener"),e.isAuthenticated?a.a.createElement(n.Fragment,null,a.a.createElement(pt,null),a.a.createElement(dt,null)):a.a.createElement(ct,null))}),ft=function(e){function t(){return Object(Ae.a)(this,t),Object(Me.a)(this,Object(We.a)(t).apply(this,arguments))}return Object(Qe.a)(t,e),Object(Ge.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.match.params.encodedPk;this.props.decodeUrlRequest(e)}},{key:"render",value:function(){var e=this.props.redirectUrl;return e?a.a.createElement("p",null,"Redirecting you to ".concat(e)):a.a.createElement("p",null,"Redirecting you to...")}}]),t}(n.Component);ft.defaultProps={redirectUrl:""};var bt={decodeUrlRequest:function(e){return{type:R,encodedPk:e}}},gt=Object(s.connect)(function(e){return{redirectUrl:e.shortener.redirectUrl}},bt)(ft),vt=(r(481),Object(_e.a)(Object(s.connect)(function(){return{}},{})(function(){return a.a.createElement("div",{className:"app"},a.a.createElement(Xe,null),a.a.createElement(De.a,null,a.a.createElement(Fe.a,{exact:!0,path:"/:encodedPk",render:function(e){return a.a.createElement(gt,e)}}),a.a.createElement(Fe.a,{exact:!0,path:"/",render:function(e){return a.a.createElement(ht,e)}})))})));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(s.Provider,{store:qe},a.a.createElement(u.ConnectedRouter,{history:Ce},a.a.createElement(vt,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[230,2,1]]]);
//# sourceMappingURL=main.aaf7f62f.chunk.js.map